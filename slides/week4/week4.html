<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>Week 4</title>
<meta name="author" content="(Kristaps Berzinch, Raymond Ortiz, Sahit Chintalapudi, Evan Bretl)"/>
<style type="text/css">
.underline { text-decoration: underline; }
</style>
<link rel="stylesheet" href="https://robojackets.github.io/reveal.js/css/reveal.css"/>

<link rel="stylesheet" href="https://robojackets.github.io/reveal.js/css/theme/white.css" id="theme"/>


<!-- If the query includes 'print-pdf', include the PDF print sheet -->
<script>
    if( window.location.search.match( /print-pdf/gi ) ) {
        var link = document.createElement( 'link' );
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = 'https://robojackets.github.io/reveal.js/css/print/pdf.css';
        document.getElementsByTagName( 'head' )[0].appendChild( link );
    }
</script>
</head>
<body>
<div class="reveal">
<div class="slides">
<section id="sec-title-slide"><h1 class="title">Week 4</h1>
</section>

<section id="slide-orgcc50be1">
<h2 id="orgcc50be1">What are we doing today?</h2>
<ul>
<li>How a program's memory is structured and maintained</li>
<li>References and pointers</li>
<li>Pass by reference/value</li>
<li>How to convert objects between different types</li>

</ul>

</section>
<section id="slide-orgbe25aa3">
<h2 id="orgbe25aa3">What is the output?</h2>
<aside class="notes">
<p>
Ask them the output of this code. Then talk about how var and a are not the same place in memory.
</p>

</aside>
<div class="org-src-container">

<pre  class="src src-c++"><code trim><span style="color: #598249;">#include</span> <span style="color: #15968D;">&lt;iostream&gt;</span>
<span style="color: #598249;">void</span> <span style="color: #2F7BDE;">increment</span>(<span style="color: #598249;">int</span> <span style="color: #2F7BDE;">a</span>) {
  a = a + 5;
}
<span style="color: #598249;">int</span> <span style="color: #2F7BDE;">main</span>() {
  <span style="color: #598249;">int</span> <span style="color: #2F7BDE;">var</span> = 5;
  increment(var);
  <span style="color: #15968D;">std</span>::cout &lt;&lt; var &lt;&lt; <span style="color: #15968D;">std</span>::endl;
}
</code></pre>
</div>

</section>
<section id="slide-org9d0e7db">
<h2 id="org9d0e7db">Memory structure</h2>
<aside class="notes">
<p>
Make sure to emphasize how important memory allocation is for any real program. This is all fundamentally the same RAM, just arranged and managed in a certain way. Static memory is used for static/global variables. A new block is allocated when a function is called, and released when the function exits - this is where your parameters and local variables are stored. Mention memory leaks.
</p>

</aside>

<div class="figure">
<p><img src="https://i.imgur.com/5dJ912z.png" alt="5dJ912z.png" />
</p>
</div>
<ul>
<li>All the memory in your computer is a huge, indexable space divided into bytes</li>
<li>Your program has three kinds of memory
<ul>
<li><b>Static memory:</b> calculated at compile time</li>
<li><b>The stack:</b> managed automatically by the language</li>
<li><b>The heap:</b> your space to do whatever you want
<ul>
<li>You can ask for heap memory from the OS</li>
<li>You have to release/free what you've allocated to avoid memory leaks</li>

</ul></li>

</ul></li>

</ul>

</section>
<section id="slide-orgd35a06b">
<h3 id="orgd35a06b">What is a byte</h3>
<aside class="notes">
<p>
They may never have seen binary before. 00101010 = 26, 00010001 = 17 do not talk about how binary works
</p>

</aside>
<ul>
<li>8 bits (0,1)
<ul>
<li>00101010</li>
<li>00010001</li>

</ul></li>
<li>smallest indexable space on your computer</li>

</ul>

</section>
<section id="slide-org0e56649">
<h3 id="org0e56649">Object lifetimes stack</h3>
<aside class="notes">
<p>
Picture on next slide. talk about how in the below example the int is allocated on the stack. mention what stack overflow is
</p>

</aside>
<ul>
<li>All variables have different lifetimes depending on where they are allocated in memory</li>
<li>Every method call has its own copy of the variables on the stack</li>

</ul>
<div class="org-src-container">

<pre  class="src src-c++"><code trim><span style="color: #598249;">#include</span> <span style="color: #15968D;">&lt;iostream&gt;</span>
<span style="color: #598249;">void</span> <span style="color: #2F7BDE;">increment</span>(<span style="color: #598249;">int</span> <span style="color: #2F7BDE;">a</span>) {
  <span style="color: #598249;">int</span> <span style="color: #2F7BDE;">c</span> = 5;
  a = a + 5;
}
<span style="color: #598249;">int</span> <span style="color: #2F7BDE;">main</span>() {
  <span style="color: #598249;">int</span> <span style="color: #2F7BDE;">d</span> = 6;
  <span style="color: #598249;">int</span> <span style="color: #2F7BDE;">var</span> = 5;
  increment(var);
  <span style="color: #15968D;">std</span>::cout &lt;&lt; var &lt;&lt; <span style="color: #15968D;">std</span>::endl;
}
</code></pre>
</div>

</section>
<section id="slide-org3b44b49">
<h4 id="org3b44b49">Stack example</h4>
<div class="org-src-container">

<pre  class="src src-c++"><code trim><span style="color: #598249;">#include</span> <span style="color: #15968D;">&lt;iostream&gt;</span>
<span style="color: #598249;">void</span> <span style="color: #2F7BDE;">increment</span>(<span style="color: #598249;">int</span> <span style="color: #2F7BDE;">a</span>) {
  <span style="color: #598249;">int</span> <span style="color: #2F7BDE;">c</span> = 5;
  a = a + 5;
}
<span style="color: #598249;">int</span> <span style="color: #2F7BDE;">main</span>() {
  <span style="color: #598249;">int</span> <span style="color: #2F7BDE;">d</span> = 6;
  <span style="color: #598249;">int</span> <span style="color: #2F7BDE;">var</span> = 5;
  increment(var);
  <span style="color: #15968D;">std</span>::cout &lt;&lt; var &lt;&lt; <span style="color: #15968D;">std</span>::endl;
}
</code></pre>
</div>

<div class="figure">
<p><img src="https://imgur.com/b6KnwB2.png" alt="b6KnwB2.png" />
</p>
</div>

</section>
<section id="slide-orgee7f46d">
<h2 id="orgee7f46d">References</h2>
<aside class="notes">
<p>
Parameters are copied into the new block so the function can't modify anything outside of its scope. Explicitly using a reference allows a function to do that.
Performance can also improve, since you're only copying a memory address instead of a (potentially) larger object. Run through some basic examples here.
</p>

</aside>
<ul>
<li>A reference is a variable that points to the same content as another variable</li>
<li>Why would you want that?
<ul>
<li>Share data across functions</li>
<li>Improve performance</li>

</ul></li>
<li>You can't change where a reference points after initialization</li>
<li>You can mostly just treat references exactly like normal variables once they're initialized</li>

</ul>

</section>
<section id="slide-org9b3fb06">
<h3 id="org9b3fb06">Passing by reference</h3>
<aside class="notes">
<p>
ask them what the output of the code is and then walk them through it
</p>

</aside>
<ul>
<li>use the <b>&amp;</b> next to a variable to make it pass by reference</li>

</ul>
<div class="org-src-container">

<pre  class="src src-c++"><code trim><span style="color: #598249;">#include</span> <span style="color: #15968D;">&lt;iostream&gt;</span>
<span style="color: #598249;">void</span> <span style="color: #2F7BDE;">increment</span>(<span style="color: #598249;">int</span> &amp;<span style="color: #2F7BDE;">a</span>) {
  a = a + 5;
}
<span style="color: #598249;">int</span> <span style="color: #2F7BDE;">main</span>() {
  <span style="color: #598249;">int</span> <span style="color: #2F7BDE;">var</span> = 5;
  increment(var);
  <span style="color: #15968D;">std</span>::cout &lt;&lt; var &lt;&lt; <span style="color: #15968D;">std</span>::endl;
}
</code></pre>
</div>

</section>
<section id="slide-org79aec41">
<h2 id="org79aec41">Pointers</h2>
<aside class="notes">
<p>
Pointers are great for passing around heap objects, but how do you keep track of what objects are still in use?
</p>

</aside>
<ul>
<li>A pointer is a special type of variable that "points to" another variable
<ul>
<li>the pointer variable stores the address of a variable</li>

</ul></li>
<li>How are these different from references?
<ul>
<li>You have to explicitly get the value a pointer is pointing to</li>
<li>You can change where a pointer is pointing</li>

</ul></li>

</ul>

</section>
<section id="slide-orgc00e153">
<h3 id="orgc00e153">How to get an address</h3>
<ul>
<li>The <b>&amp;</b> operator is used to get an address of a variable</li>
<li>Use the <b>*</b> operator to denote a pointer variable</li>

</ul>
<div class="org-src-container">

<pre  class="src src-c++"><code trim><span style="color: #598249;">int</span> <span style="color: #2F7BDE;">main</span>() {
  <span style="color: #598249;">int</span> <span style="color: #2F7BDE;">var</span> = 5;
  <span style="color: #5e6263;">// </span><span style="color: #5e6263;">TYPE* name;</span>
  <span style="color: #598249;">int</span>* <span style="color: #2F7BDE;">var_ptr</span> = &amp;var;
}
</code></pre>
</div>

</section>
<section id="slide-orgc7b7057">
<h4 id="orgc7b7057">Example</h4>
<div class="org-src-container">

<pre  class="src src-c++"><code trim><span style="color: #598249;">int</span> <span style="color: #2F7BDE;">main</span>() {
  <span style="color: #598249;">int</span> <span style="color: #2F7BDE;">var</span> = 5;
  <span style="color: #5e6263;">// </span><span style="color: #5e6263;">TYPE* name;</span>
  <span style="color: #598249;">int</span>* <span style="color: #2F7BDE;">var_ptr</span> = &amp;var;
}
</code></pre>
</div>

<div class="figure">
<p><img src="https://imgur.com/HvxBD32.png" alt="HvxBD32.png" />
</p>
</div>

</section>
<section id="slide-orgfa2dfeb">
<h3 id="orgfa2dfeb">Dereferencing pointers</h3>
<ul>
<li>gets the value pointed to
<ul>
<li>here is an address, what is there?</li>

</ul></li>
<li>use the <b>*</b> operator in front of a pointer to dereference it</li>
<li>use the <code>-&gt;</code> operator behind a pointer to deference and do something else</li>

</ul>

</section>
<section id="slide-orgc2a4a4a">
<h3 id="orgc2a4a4a">Example</h3>
<aside class="notes">
<p>
Now run through some basic examples
</p>

</aside>
<div class="org-src-container">

<pre  class="src src-c++"><code trim><span style="color: #598249;">#include</span> <span style="color: #15968D;">&lt;iostream&gt;</span>
<span style="color: #598249;">int</span> <span style="color: #2F7BDE;">main</span>() {
  <span style="color: #598249;">int</span> <span style="color: #2F7BDE;">var</span> = 5;
  <span style="color: #5e6263;">// </span><span style="color: #5e6263;">TYPE* name;</span>
  <span style="color: #598249;">int</span>* <span style="color: #2F7BDE;">var_ptr</span> = &amp;var;
  <span style="color: #15968D;">std</span>::cout &lt;&lt; *var_ptr &lt;&lt; <span style="color: #15968D;">std</span>::endl;
}
</code></pre>
</div>

<div class="figure">
<p><img src="https://imgur.com/7alG4QH.png" alt="7alG4QH.png" />
</p>
</div>

</section>
<section id="slide-org814f6c7">
<h3 id="org814f6c7">Another example</h3>
<div class="org-src-container">

<pre  class="src src-c++"><code trim><span style="color: #598249;">#include</span> <span style="color: #15968D;">&lt;iostream&gt;</span>
<span style="color: #598249;">#include</span> <span style="color: #15968D;">&lt;string&gt;</span>

<span style="color: #598249;">int</span> <span style="color: #2F7BDE;">main</span>() {
  <span style="color: #598249;">int</span> <span style="color: #2F7BDE;">var</span> = 5;
  <span style="color: #15968D;">std</span>::<span style="color: #598249;">string</span> <span style="color: #2F7BDE;">s</span> = <span style="color: #15968D;">"Pointers are fun"</span>;

  <span style="color: #5e6263;">// </span><span style="color: #5e6263;">TYPE* name;</span>
  <span style="color: #598249;">int</span>* <span style="color: #2F7BDE;">var_ptr</span> = &amp;var;

  <span style="color: #15968D;">std</span>::<span style="color: #598249;">string</span>* <span style="color: #2F7BDE;">str_ptr</span> = &amp;s;
  str_ptr-&gt;push_back(<span style="color: #15968D;">'!'</span>);

  <span style="color: #15968D;">std</span>::cout &lt;&lt; <span style="color: #15968D;">"var_ptr is "</span> &lt;&lt; *var_ptr &lt;&lt; <span style="color: #15968D;">std</span>::endl;
  <span style="color: #15968D;">std</span>::cout &lt;&lt; <span style="color: #15968D;">"str_ptr has size "</span> &lt;&lt; str_ptr-&gt;size() &lt;&lt; <span style="color: #15968D;">std</span>::endl;
  <span style="color: #15968D;">std</span>::cout &lt;&lt; <span style="color: #15968D;">"Now s is: "</span> &lt;&lt; s &lt;&lt; <span style="color: #15968D;">std</span>::endl;
}

</code></pre>
</div>

</section>
<section id="slide-orgb373c71">
<h2 id="orgb373c71">Pointer arithmatic</h2>
<ul>
<li>In c++ different datatypes have different sizes</li>
<li>A pointer will increment differently based on its datatype's size in bytes</li>

</ul>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left"><code>type</code></th>
<th scope="col" class="org-right"><code># bytes</code></th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">char</td>
<td class="org-right">1</td>
</tr>

<tr>
<td class="org-left">int</td>
<td class="org-right">4</td>
</tr>

<tr>
<td class="org-left">double</td>
<td class="org-right">8</td>
</tr>
</tbody>
</table>

</section>
<section id="slide-orgcf344a6">
<h3 id="orgcf344a6">Example int</h3>
<div class="org-src-container">

<pre  class="src src-c++"><code trim><span style="color: #598249;">#include</span> <span style="color: #15968D;">&lt;iostream&gt;</span>
<span style="color: #598249;">int</span> <span style="color: #2F7BDE;">main</span>() {
  <span style="color: #598249;">int</span> <span style="color: #2F7BDE;">var</span> = 6;
  <span style="color: #598249;">int</span>* <span style="color: #2F7BDE;">var_ptr</span> = &amp;var;
  var_ptr += 1;
}
</code></pre>
</div>

<div class="figure">
<p><img src="https://imgur.com/74Lb2KQ.png" alt="74Lb2KQ.png" />
</p>
</div>

</section>
<section id="slide-orge7fab6c">
<h3 id="orge7fab6c">Example char</h3>
<div class="org-src-container">

<pre  class="src src-c++"><code trim><span style="color: #598249;">#include</span> <span style="color: #15968D;">&lt;iostream&gt;</span>
<span style="color: #598249;">int</span> <span style="color: #2F7BDE;">main</span>() {
  <span style="color: #598249;">char</span> <span style="color: #2F7BDE;">rj</span> = <span style="color: #15968D;">'c'</span>;
  <span style="color: #598249;">char</span>* <span style="color: #2F7BDE;">char_ptr</span> = &amp;rj;
  char_ptr += 2;
}
</code></pre>
</div>

<div class="figure">
<p><img src="https://imgur.com/vc7sR0R.png" alt="vc7sR0R.png" />
</p>
</div>

</section>
<section id="slide-org12ba302">
<h2 id="org12ba302">New / Delete</h2>
<aside class="notes">
<p>
do example when you get to the delete slide
</p>

</aside>
<ul>
<li>To allocate memory on the heap you can use <b>new</b>
<ul>
<li>be careful how much you allocate</li>
<li>returns a pointer to the memory</li>

</ul></li>
<li>To deallocate the memory you must use <b>delete</b>
<ul>
<li>anytime memory is allocated you must deallocate it</li>
<li>you pass the pointer to the memory you got from new</li>
<li>not deallocating is the cause of memory leaks
<ul>
<li>stay tuned for a demo</li>

</ul></li>

</ul></li>

</ul>

</section>
<section id="slide-org9224ce0">
<h3 id="org9224ce0">New</h3>
<div class="org-src-container">

<pre  class="src src-c++"><code trim><span style="color: #598249;">int</span> <span style="color: #2F7BDE;">main</span>() {
  <span style="color: #598249;">double</span> *<span style="color: #2F7BDE;">a</span> = <span style="color: #598249;">new</span> <span style="color: #598249;">double</span>(10.0);
}
</code></pre>
</div>

<div class="figure">
<p><img src="https://imgur.com/z3xGol7.png" alt="z3xGol7.png" />
</p>
</div>

</section>
<section id="slide-org8502beb">
<h3 id="org8502beb">Delete</h3>
<aside class="notes">
<p>
use the stuct defined in week4.h, prints when constructed and destructed.
</p>

</aside>
<div class="org-src-container">

<pre  class="src src-c++"><code trim><span style="color: #598249;">int</span> <span style="color: #2F7BDE;">main</span>() {
  <span style="color: #598249;">double</span> *<span style="color: #2F7BDE;">a</span> = <span style="color: #598249;">new</span> <span style="color: #598249;">double</span>(10.0);
  <span style="color: #5e6263;">// </span><span style="color: #5e6263;">... legit code</span>
  <span style="color: #598249;">delete</span> a;
}
</code></pre>
</div>

<div class="figure">
<p><img src="https://imgur.com/A6a4bsz.png" alt="A6a4bsz.png" />
</p>
</div>

</section>
<section id="slide-org5c7bb30">
<h4 id="org5c7bb30">Segfault</h4>
<aside class="notes">
<p>
tell them what a segfault is
</p>

</aside>
<div class="org-src-container">

<pre  class="src src-c++"><code trim><span style="color: #598249;">int</span> <span style="color: #2F7BDE;">main</span>() {
  <span style="color: #598249;">double</span> *<span style="color: #2F7BDE;">a</span> = <span style="color: #598249;">new</span> <span style="color: #598249;">double</span>(10.0);
  <span style="color: #5e6263;">// </span><span style="color: #5e6263;">... legit code</span>
  <span style="color: #598249;">delete</span> a;
  <span style="color: #5e6263;">// </span><span style="color: #5e6263;">.. more code</span>
  *a = 20.0
  <span style="color: #5e6263;">// </span><span style="color: #5e6263;">.. more code</span>
}
</code></pre>
</div>

</section>
<section id="slide-org07df025">
<h2 id="org07df025">Smart pointers</h2>
<aside class="notes">
<p>
Each type has an initialization function. Run through examples in 4 slides
</p>

</aside>
<ul>
<li>A smart pointer object manages a pointer</li>
<li>When the smart pointer is done (e.g. end of function), calls <code>delete</code> on its data</li>
<li>You should generally use one of these two types instead of a normal pointer:
<ul>
<li><code>shared_ptr</code>: multiple <code>shared_ptr</code> objects can own a single pointer</li>
<li><code>unique_ptr</code>: only one <code>unique_ptr</code> can own an pointer</li>

</ul></li>

</ul>

</section>
<section id="slide-orgc149281">
<h3 id="orgc149281"><code>unique_ptr</code></h3>
<aside class="notes">
<p>
object is a struct defined in week4.h. make sure to use it as an example
</p>

</aside>
<div class="org-src-container">

<pre  class="src src-c++"><code trim><span style="color: #598249;">int</span> <span style="color: #2F7BDE;">main</span>() {
  <span style="color: #598249;">unique_ptr</span>&lt;object&gt; <span style="color: #2F7BDE;">u_ptr</span> = make_unique&lt;object&gt;();
}
</code></pre>
</div>

<div class="figure">
<p><img src="https://i.imgur.com/nK51rsP.png" alt="nK51rsP.png" width="70%" />
</p>
</div>

</section>
<section id="slide-org7461b17">
<h3 id="org7461b17"><code>shared_ptr</code></h3>
<aside class="notes">
<p>
object is a struct defined in week4.h. make sure to use it as an example
</p>

</aside>
<div class="org-src-container">

<pre  class="src src-c++"><code trim><span style="color: #598249;">int</span> <span style="color: #2F7BDE;">main</span>() {
  <span style="color: #598249;">shared_ptr</span>&lt;object&gt; <span style="color: #2F7BDE;">s_ptr1</span> = make_shared&lt;object&gt;();
  <span style="color: #5e6263;">// </span><span style="color: #5e6263;">&lt;--- HERE</span>
  {
    <span style="color: #598249;">shared_ptr</span>&lt;object&gt; <span style="color: #2F7BDE;">s_ptr2</span> = s_ptr1;
  }
  <span style="color: #598249;">shared_ptr</span>&lt;object&gt; <span style="color: #2F7BDE;">s_ptr3</span> =  s_ptr1;
}
</code></pre>
</div>

<div class="figure">
<p><img src="https://i.imgur.com/Sy6CY5q.png" alt="Sy6CY5q.png" width="70%" />
</p>
</div>

</section>
<section id="slide-org2b80ac5">
<h4 id="org2b80ac5"><code>shared_ptr</code></h4>
<aside class="notes">
<p>
object is a struct defined in week4.h. make sure to use it as an example
</p>

</aside>
<div class="org-src-container">

<pre  class="src src-c++"><code trim><span style="color: #598249;">int</span> <span style="color: #2F7BDE;">main</span>() {
  <span style="color: #598249;">shared_ptr</span>&lt;object&gt; <span style="color: #2F7BDE;">s_ptr1</span> = make_shared&lt;object&gt;();
  {
    <span style="color: #598249;">shared_ptr</span>&lt;object&gt; <span style="color: #2F7BDE;">s_ptr2</span> =  s_ptr1;
    <span style="color: #5e6263;">// </span><span style="color: #5e6263;">&lt;--- HERE</span>
  }
  <span style="color: #598249;">shared_ptr</span>&lt;object&gt; <span style="color: #2F7BDE;">s_ptr3</span> =  s_ptr1;
}
</code></pre>
</div>

<div class="figure">
<p><img src="https://i.imgur.com/y3ITWBn.png" alt="y3ITWBn.png" width="70%" />
</p>
</div>

</section>
<section id="slide-orge286727">
<h4 id="orge286727"><code>shared_ptr</code></h4>
<aside class="notes">
<p>
object is a struct defined in week4.h. make sure to use it as an example
</p>

</aside>
<div class="org-src-container">

<pre  class="src src-c++"><code trim><span style="color: #598249;">int</span> <span style="color: #2F7BDE;">main</span>() {
  <span style="color: #598249;">shared_ptr</span>&lt;object&gt; <span style="color: #2F7BDE;">s_ptr1</span> = make_shared&lt;object&gt;();
  {
    <span style="color: #598249;">shared_ptr</span>&lt;object&gt; <span style="color: #2F7BDE;">s_ptr2</span> =  s_ptr1;
  }
  <span style="color: #598249;">shared_ptr</span>&lt;object&gt; <span style="color: #2F7BDE;">s_ptr3</span> =  s_ptr1;
  <span style="color: #5e6263;">// </span><span style="color: #5e6263;">&lt;--- HERE</span>
}
</code></pre>
</div>

<div class="figure">
<p><img src="https://i.imgur.com/LV3kigZ.png" alt="LV3kigZ.png" width="70%" />
</p>
</div>

</section>
<section id="slide-orgbad57a7">
<h2 id="orgbad57a7">Ownership</h2>
<ul>
<li>be careful about returning a shared pointer from a method
<ul>
<li>who owns what?</li>

</ul></li>

</ul>

</section>
<section id="slide-org9857c04">
<h2 id="org9857c04">Casting, the wrong way</h2>
<ul>
<li>Sometimes you want to convert a variable to a different type: this is called casting</li>
<li>In C, you can simply change the type of a variable like so:</li>

</ul>
<div class="org-src-container">

<pre  class="src src-c++"><code trim><span style="color: #598249;">B</span>* <span style="color: #2F7BDE;">old_var</span> = <span style="color: #598249;">new</span> <span style="color: #598249;">B</span>(); <span style="color: #5e6263;">// </span><span style="color: #5e6263;">some object</span>
<span style="color: #598249;">A</span>* <span style="color: #2F7BDE;">new_var</span> = (<span style="color: #598249;">A</span>*)old_var;
</code></pre>
</div>
<ul>
<li>The compiler will now treat the bytes of object <code>old_var</code> as though it was of type <code>A</code></li>
<li>This is bad for type safety!</li>

</ul>

</section>
<section id="slide-org9ebdf63">
<h2 id="org9ebdf63">Type Safety</h2>
<div class="org-src-container">

<pre  class="src src-c++"><code trim><span style="color: #598249;">char</span> <span style="color: #2F7BDE;">c</span> = 10;                        <span style="color: #5e6263;">// </span><span style="color: #5e6263;">this is one byte in memory</span>

<span style="color: #598249;">int</span> *<span style="color: #2F7BDE;">p</span> = (<span style="color: #598249;">int</span>*) &amp;c;                 <span style="color: #5e6263;">// </span><span style="color: #5e6263;">this is a 4-byte pointer pointing to one byte of</span>
                                    <span style="color: #5e6263;">// </span><span style="color: #5e6263;">memory - it compiles but leads to corrupted memory</span>
                                    <span style="color: #5e6263;">// </span><span style="color: #5e6263;">if you try to write to what p points to</span>

<span style="color: #598249;">int</span> *<span style="color: #2F7BDE;">q</span> = <span style="color: #598249;">static_cast</span>&lt;<span style="color: #598249;">int</span>*&gt;(&amp;c);     <span style="color: #5e6263;">// </span><span style="color: #5e6263;">throws an exception at compile time</span>
</code></pre>
</div>
<ul>
<li>Our second cast was type-safe, the first one was not</li>
<li>Type safety is a language feature that ensures that every variable you handle is actually the type you think it is
<ul>
<li>The compiler will check each time you assign a variable to ensure the types are compatible</li>

</ul></li>

</ul>

</section>
<section id="slide-org4825ea9">
<h2 id="org4825ea9">Casting, the right way</h2>
<aside class="notes">
<p>
Really talk about why type safety is good. otherwise you can arbitrarily cast any type to any other. You might not make the mistake but someone else will
</p>

</aside>
<ul>
<li>C++ gives us functions that are type-safe, including compile-time checks
<ul>
<li><code>static_cast</code> is mostly used for basic type conversions, e.g. between different types of numbers</li>
<li><code>dynamic_cast</code> is mostly used for conversions between object types for polymorphism</li>
<li><code>reinterpret_cast</code> works like a C-style cast and generally shouldn't be used unless you know exactly what you're doing</li>

</ul></li>

</ul>


</section>
<section id="slide-orga13846b">
<h2 id="orga13846b">Exercise: line following with a twist</h2>
<ul>
<li>Modify <code>line_follow.cpp</code></li>
<li>You should make 2 functions <code>turn_right</code> and <code>turn_left</code></li>
<li>We can't use the function signature <code>turn_left(RJRobot r)</code>
<ul>
<li>This copies the RJRobot object, opening a second wifi link to the robot (which doesn't work)</li>

</ul></li>

</ul>


</section>
<section id="slide-orgccb3604">
<h2 id="orgccb3604">Exercise cont'd</h2>
<ul>
<li>You can solve this problem several ways by changing the function signature. For practice, try these three:
<ol>
<li>Pass a reference to the RJRobot</li>
<li>Pass a pointer to the RJRobot (a non-smart pointer is fine)</li>
<li>Pass no parameters
<ul>
<li>Declare a global (outside of any function) <code>unique_ptr</code> to an RJRobot</li>
<li>Don't forget to <code>make_unique</code> in <code>main</code></li>
<li>You can use this <code>unique_ptr</code> in any function</li>

</ul></li>

</ol></li>

<li>Line follow algorithm:
<ul>
<li><code>repeat forever: if (sensor &lt; threshold) then turn_left, else turn_right</code></li>

</ul></li>

</ul>
</section>
</section>
</div>
</div>
<script src="https://robojackets.github.io/reveal.js/js/reveal.js"></script>

<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({
multiplex: {
    secret: '', // null if client
    id: '', // id, obtained from socket.io server
    url: '' // Location of socket.io server
},

// Optional libraries used to extend on reveal.js
dependencies: [
 { src: 'https://robojackets.github.io/reveal.js/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } },
]
});
</script>
</body>
</html>
